## 数据区结构示意图

如下图所示，主要包括 虚拟机栈、本地方法栈、程序计数器、方法区、堆区。

![](assets/jvm_data_struct.png)

1. 程序计数器(Program Register)：用于保存当前线程执行的内存地址。由于JVM程序是多线程执行的（线程轮流切换），所以为了保证线程切换回来后，还能恢复到原先状态，就需要一个独立的计数器，记录之前中断的地方。
2. 虚拟机栈(VM Stack)：虚拟机栈总是和线程关联在一起，每当创建一个线程时，JVM就会为这个线程创建一个对应的虚拟机栈。在这个虚拟机栈中又会包含多个栈帧，每运行一个方法就创建一个栈帧，用于存储局部变量表、操作栈、方法返回值等。每一个方法从调用直至执行完成的过程，就对应一个栈帧在虚拟机栈中入栈到出栈的过程。
3. 本地方法栈(Native Method Stack)：为JVM使用到的native方法服务，用于存储局部变量表、操作栈、方法返回值等，与VM Stack类似。
4. 堆(Heap)：存储java实例或者对象的地方。这块是GC的主要区域。
5. 方法区(Method Area)：用于存储类结构信息的地方，包括常量池、静态变量、构造函数，运行时常量池等元数据。


#### String的处理
以前老是碰到面试问地下两个有啥区别？
```java
String s = "abc";
String s = new String("abc");
```
实际使用中把String当作基本类型之一来用就好了。

`String s = "abc";` 会先去常量池找对象，没有就往池子加一个并返回。  
`String s = new String("abc");` 会先再堆空间创建一个对象，再去常量池找对象，没有就往池子里加一个。